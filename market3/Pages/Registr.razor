@using Microsoft.AspNetCore.SignalR.Client
@using market3.DataBase;
@using Microsoft.AspNetCore.Components.Forms;
@inject JSRuntime JSRuntime;
@inject ProductHub ProductHub;
@inject NavigationManager NavigationManager;
@page "/Register"
<h3>Регистрация пользователя</h3>
<EditForm Model="@user" OnValidSubmit="HandleRegister">
    <label > Имя пользователя</label>
    <InputText @bind-Value="user.Name" />
    <label>Пароль</label>
    <InputText @bind-Value="user.Password" type="password"/>
    <button type="submit">Зарегистрироваться</button>

</EditForm>

@code {
    public class RegisterModel
    {
        public string Name { get; set; }
        public string Password { get; set; }
    }
    private RegisterModel user = new RegisterModel();

    private async Task HandleRegister()
    {
        bool success = await ProductHub.RegisterAsync(user.Name, user.Password);
        if (success)
        {
            await JSRuntime.InvokeVoidAsync("localStorage.setItem", "username",
            user.Name);
            NavigationManager.NavigateTo("/");
        }
    }
}
